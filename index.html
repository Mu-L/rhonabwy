<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Rhonabwy: Rhonabwy - JWK, JWKS and JWS library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Rhonabwy
   </div>
   <div id="projectbrief">Create, modify, parse or export Json Web Keys as defined in the RFC 7517</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Rhonabwy - JWK, JWKS and JWS library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.com/babelouest/rhonabwy"></a> </p><div class="image">
<object type="image/svg+xml" data="https://github.com/babelouest/rhonabwy/workflows/C/C++%20CI/badge.svg" alt="C/C++ CI"></object>
</div>
<ul>
<li>Create, modify, parse, import or export <a href="https://tools.ietf.org/html/rfc7517">JSON Web Keys</a> (JWK) and JSON Web Keys Set (JWKS)</li>
<li>Create, modify, parse, validate or serialize <a href="https://tools.ietf.org/html/rfc7515">JSON Web Signatures</a> (JWS)</li>
<li>Create, modify, parse, validate or serialize <a href="https://tools.ietf.org/html/rfc7516">JSON Web Encryption</a> (JWE) (limited and experimental)</li>
<li>Supported Cryptographic Algorithms for Digital Signatures and MACs:<ul>
<li>HMAC with SHA-2 Functions: <code>HS256</code>, <code>HS384</code>, <code>HS512</code></li>
<li>Digital Signature with RSASSA-PKCS1-v1_5: <code>RS256</code>, <code>RS384</code>, <code>RS512</code></li>
<li>Digital Signature with ECDSA: <code>ES256</code>, <code>ES384</code>, <code>ES512</code></li>
<li>Digital Signature with RSASSA-PSS: <code>PS256</code>, <code>PS384</code>, <code>PS512</code></li>
<li>Digital Signature with Ed25519 Elliptic Curve: <code>EDDSA</code></li>
<li>Unsecured: <code>none</code></li>
</ul>
</li>
</ul>
<p>JWE support is experimental and limited, please use with great caution!</p><ul>
<li>Supported Encryption Algorithm (<code>enc</code>) for JWE payload encryption: <code>A128CBC-HS256</code>, <code>A192CBC-HS384</code>, <code>A256CBC-HS512</code>, <code>A128GCM</code>, <code>A256GCM</code></li>
<li>Supported Cryptographic Algorithms for Key Management: <code>RSA1_5</code> (RSAES-PKCS1-v1_5), <code>dir</code> (Direct use of a shared symmetric)</li>
</ul>
<p>Example program to parse and verify the signature of a JWT using its publick key in JWK format:</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rhonabwy_8h.html">rhonabwy.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>) {</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> jws_token[] = <span class="stringliteral">&quot;eyJhbGciOiJFUzI1NiIsImtpZCI6IjEifQ.&quot;</span></div><div class="line">    <span class="stringliteral">&quot;VGhlIHRydWUgc2lnbiBvZiBpbnRlbGxpZ2VuY2UgaXMgbm90IGtub3dsZWRnZSBidXQgaW1hZ2luYXRpb24u.&quot;</span></div><div class="line">    <span class="stringliteral">&quot;8SGjljD8Zrj9nZRXFbWny8KYLokjvnuFersudKTYCU7LyiOHed81goqaW3J1gDY-8zIjGnT_EV2YZsT7GVyBjQ&quot;</span>;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> jwk_pubkey_ecdsa_str[] = <span class="stringliteral">&quot;{\&quot;kty\&quot;:\&quot;EC\&quot;,\&quot;crv\&quot;:\&quot;P-256\&quot;,\&quot;x\&quot;:\&quot;MKBCTNIcKUSDii11ySs3526iDZ8AiTo7Tu6KPAqv7D4\&quot;,&quot;</span>\</div><div class="line">                                      <span class="stringliteral">&quot;\&quot;y\&quot;:\&quot;4Etl6SRW2YiLUrN5vfvVHuhp7x8PxltmWWlbbM4IFyM\&quot;,\&quot;use\&quot;:\&quot;enc\&quot;,\&quot;kid\&quot;:\&quot;1\&quot;,\&quot;alg\&quot;:\&quot;ES256\&quot;}&quot;</span>;</div><div class="line"></div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> output[2048];</div><div class="line">  <span class="keywordtype">size_t</span> output_len = 2048;</div><div class="line">  <a class="code" href="group__type.html#gac7d996dfabdc443bcd0da0b6574e22ef">jwk_t</a> * jwk;</div><div class="line">  <a class="code" href="structjws__t.html">jws_t</a> * jws;</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__core.html#gaf6734cc4f9ab69d875ff86d60aee3c06">r_jwk_init</a>(&amp;jwk) == <a class="code" href="group__const.html#ga3fc690cb1d601c13fce959aff60de0d7">RHN_OK</a>) {</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__core.html#ga365c9ed016d8034d1bc5a00b686c859b">r_jws_init</a>(&amp;jws) == <a class="code" href="group__const.html#ga3fc690cb1d601c13fce959aff60de0d7">RHN_OK</a>) {</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="group__import.html#ga19c4a32dc17dc0c11a452b177c83b1aa">r_jwk_import_from_json_str</a>(jwk, jwk_pubkey_ecdsa_str) == <a class="code" href="group__const.html#ga3fc690cb1d601c13fce959aff60de0d7">RHN_OK</a>) {</div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__export.html#ga74345c97b9d9df7ed96e8fe691818ad1">r_jwk_export_to_pem_der</a>(jwk, <a class="code" href="group__const.html#gadf1b327996f4bf1fd1e9ae7a4a29f8f5">R_FORMAT_PEM</a>, output, &amp;output_len, 0) == <a class="code" href="group__const.html#ga3fc690cb1d601c13fce959aff60de0d7">RHN_OK</a>) {</div><div class="line">          printf(<span class="stringliteral">&quot;Exported key:\n%.*s\n&quot;</span>, (<span class="keywordtype">int</span>)output_len, output);</div><div class="line">          <span class="keywordflow">if</span> (<a class="code" href="group__jws.html#gae1b043a46071322f988c8d714883a208">r_jws_parse</a>(jws, jws_token, 0) == <a class="code" href="group__const.html#ga3fc690cb1d601c13fce959aff60de0d7">RHN_OK</a>) {</div><div class="line">            <span class="keywordflow">if</span> (<a class="code" href="group__jws.html#ga2f4b76d9600759ef920c0d389ae19fda">r_jws_verify_signature</a>(jws, jwk, 0) == <a class="code" href="group__const.html#ga3fc690cb1d601c13fce959aff60de0d7">RHN_OK</a>) {</div><div class="line">              printf(<span class="stringliteral">&quot;Verified payload:\n%.*s\n&quot;</span>, (<span class="keywordtype">int</span>)jws-&gt;<a class="code" href="structjws__t.html#a1d1adf6f3e36d984d80b80b71c514e67">payload_len</a>, jws-&gt;<a class="code" href="structjws__t.html#a32d04764febfe083c189420949c1f29d">payload</a>);</div><div class="line">            }</div><div class="line">          }</div><div class="line">        }</div><div class="line">      }</div><div class="line">      <a class="code" href="group__core.html#ga4f008bda5b951380b6eaa99d35779d64">r_jws_free</a>(jws);</div><div class="line">    }</div><div class="line">    <a class="code" href="group__core.html#ga5132358e821050897ea7e65b0a6e324b">r_jwk_free</a>(jwk);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h1>Installation</h1>
<h2>Pre-compiled packages</h2>
<p>You can install Rhonabwy with a pre-compiled package available in the <a href="https://github.com/babelouest/rhonabwy/releases/latest/">release pages</a>.</p>
<h2>Manual install</h2>
<h3>Prerequisites</h3>
<p>You must install <a href="https://github.com/babelouest/orcania">liborcania</a>, <a href="https://github.com/babelouest/yder">libyder</a>, <a href="https://github.com/babelouest/ulfius">libulfius</a>, <a href="http://www.digip.org/jansson/">jansson</a> and <a href="https://www.gnutls.org/">GnuTLS</a> first before building librhonabwy. Orcania, Yder and Ulfius will be automatically installed if missing and you're using cmake.</p>
<p>GnuTLS is required, 3.6 minimum for ECDSA and Ed25519 (EDDSA) signatures.</p>
<h3>CMake - Multi architecture</h3>
<p><a href="https://cmake.org/download/">CMake</a> minimum 3.5 is required.</p>
<p>Run the cmake script in a subdirectory, example:</p>
<div class="fragment"><div class="line">$ git clone https://github.com/babelouest/rhonabwy.git</div><div class="line">$ cd rhonabwy/</div><div class="line">$ mkdir build</div><div class="line">$ cd build</div><div class="line">$ cmake ..</div><div class="line">$ make &amp;&amp; sudo make install</div></div><!-- fragment --><p>The available options for cmake are:</p><ul>
<li><code>-DWITH_JOURNALD=[on|off]</code> (default <code>on</code>): Build with journald (SystemD) support</li>
<li><code>-BUILD_RHONABWY_TESTING=[on|off]</code> (default <code>off</code>): Build unit tests</li>
<li><code>-DINSTALL_HEADER=[on|off]</code> (default <code>on</code>): Install header file <code><a class="el" href="rhonabwy_8h.html" title="Rhonabwy JSON Web Key (JWK) library. ">rhonabwy.h</a></code></li>
<li><code>-DBUILD_RPM=[on|off]</code> (default <code>off</code>): Build RPM package when running <code>make package</code></li>
<li><code>-DCMAKE_BUILD_TYPE=[Debug|Release]</code> (default <code>Release</code>): Compile with debugging symbols or not</li>
<li><code>-DBUILD_STATIC=[on|off]</code> (default <code>off</code>): Compile static library</li>
<li><code>-DBUILD_RHONABWY_DOCUMENTATION=[on|off]</code> (default <code>off</code>): Build documentation with doxygen</li>
</ul>
<h3>Good ol' Makefile</h3>
<p>Download rhonabwy from github repository, compile and install.</p>
<div class="fragment"><div class="line">$ git clone https://github.com/babelouest/rhonabwy.git</div><div class="line">$ cd rhonabwy/src</div><div class="line">$ make</div><div class="line">$ sudo make install</div></div><!-- fragment --><p>By default, the shared library and the header file will be installed in the <code>/usr/local</code> location. To change this setting, you can modify the <code>DESTDIR</code> value in the <code>src/Makefile</code>.</p>
<p>Example: install rhonabwy in /tmp/lib directory</p>
<div class="fragment"><div class="line">$ cd src</div><div class="line">$ make &amp;&amp; make DESTDIR=/tmp install</div></div><!-- fragment --><p>You can install Rhonabwy without root permission if your user has write access to <code></code>. A <code>ldconfig</code> command is executed at the end of the install, it will probably fail if you don't have root permission, but this is harmless. If you choose to install Rhonabwy in another directory, you must set your environment variable <code>LD_LIBRARY_PATH</code> properly.</p>
<h1>API Documentation</h1>
<p>Documentation is available in the documentation page: <a href="https://babelouest.github.io/rhonabwy/">https://babelouest.github.io/rhonabwy/</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
